if(oClient.willAutoGetToken())MyLogger.log("Token does not exists, get a token"),oClient.getAccessToken();else{MyLogger.log("Token exists or user signed out");var token=oClient.getToken();MyLogger.log("Token: "+token);null!=token?(oClient.willGetInfo()?(MyLogger.log("UserId not exists, get info"),oClient.getUserInfo()):(MyUserClient.update_vip(),MyLogger.log("UserId exists"),MyLogger.log("UserId: "+oClient.getUserId()),oClient.setUserLayout(oClient.getUserMsisdn(),oClient.getUserAvatar(),oClient.isVipUser(),
oClient.getUserType()),MyPopupClient.showPopupVisit(),MyPopupClient.popup(MyConstant.getParameter("LINEHOT")),MyBannerClient.banner("")),MyLogger.log("Check if token expire or not"),oClient.willRefreshToken()&&oClient.refreshToken()):(MyLogger.log("User signed out"),oClient.getStorage().clear(),oClient.setAnonymousLayout(),MyPopupClient.showPopupVisit(),MyPopupClient.popup(MyConstant.getParameter("LINEHOT")),MyBannerClient.banner(""))}
jQuery(document).ready(function(){jQuery("body").on("click","#user_lnk",function(){MyPopupClient.PopupNoticeInstallApp()});jQuery("body").on("click","#imgAvatar",function(){MyPopupClient.PopupNoticeInstallApp()});jQuery("body").on("click","#username",function(){MyPopupClient.PopupNoticeInstallApp()});jQuery("body").on("click",".login-show-drop",function(){MyPopupClient.PopupNoticeInstallApp()})});jQuery(window).load(function(){});
function getParameterByName(b,a){a||(a=window.location.href);a=a.toLowerCase();b=b.replace(/[\[\]]/g,"\\$&").toLowerCase();var c=(new RegExp("[?&]"+b+"(=([^&#]*)|&|#|$)")).exec(a);return c?c[2]?decodeURIComponent(c[2].replace(/\+/g," ")):"":null}
function setKeengInfo(b,a,c,f,k,l,m,n){var p=window.location.href,d=new MyOauthClient,h="";0==d.willGetToken()&&(h=d.getUserMsisdn(),d.isVipUser());var e=MyConstant.getParameter("URL_SERVICE");switch(a){case MyConstant.getParameter("LOG_TYPE_VIDEO"):case MyConstant.getParameter("LOG_TYPE_SONG"):case MyConstant.getParameter("LOG_TYPE_ALBUM"):var g="action_type="+ACTION_TYPE.LISTEN+"&item_type="+a+"&item_id="+b,e=e+MyConstant.getParameter("USER_LOG_ITEM");jQuery.ajax({type:"POST",beforeSend:function(a){a.setRequestHeader("iswap",
1);0==d.willGetToken()&&a.setRequestHeader("session_token",d.getToken())},url:e,data:g,success:function(a){console.log("data ="+a.data);null!=a.data&&void 0!=a.data&&"1"==a.data&&console.log("write log listen success")}});break;case MyConstant.getParameter("USER_LOG_ITEM"):case MyConstant.getParameter("CATE_AUDIO"):case MyConstant.getParameter("CATE_AUDIO_NOIBAT"):case MyConstant.getParameter("CATE_AUDIO_NGHENHIEU"):case MyConstant.getParameter("CATE_AUDIO_NEW"):case MyConstant.getParameter("CATE_VIDEO"):case MyConstant.getParameter("CATE_VIDEO_NOIBAT"):case MyConstant.getParameter("CATE_VIDEO_NGHENHIEU"):case MyConstant.getParameter("CATE_VIDEO_NEW"):case MyConstant.getParameter("CATE_ALBUM"):case MyConstant.getParameter("CATE_ALBUM_NGHENHIEU"):case MyConstant.getParameter("CATE_ALBUM_NOIBAT"):case MyConstant.getParameter("CATE_ALBUM_NEW"):case MyConstant.getParameter("CATE_ALBUM_CASY"):case MyConstant.getParameter("CATE_ALBUM_VIDEO"):case MyConstant.getParameter("CATE_ALBUM_MOINHAT"):case MyConstant.getParameter("CATE_ALBUM_TYPE_HOT"):case MyConstant.getParameter("CATE_BXH"):case MyConstant.getParameter("CATE_BXH_SONG_VN"):case MyConstant.getParameter("CATE_BXH_SONG_CHAUA"):case MyConstant.getParameter("CATE_BXH_SONG_AM"):case MyConstant.getParameter("CATE_BXH_VIDEO_VN"):case MyConstant.getParameter("CATE_BXH_VIDEO_CA"):case MyConstant.getParameter("CATE_BXH_VIDEO_AM"):case MyConstant.getParameter("CATE_TV"):case MyConstant.getParameter("CATE_TOPIC"):case MyConstant.getParameter("CATE_RADIO"):case MyConstant.getParameter("CATE_NGHESI"):case MyConstant.getParameter("CATE_CAMXUCAMNHAC"):case MyConstant.getParameter("CATE_NHACDANGHOT"):case MyConstant.getParameter("CATE_KEENGBLOG"):case MyConstant.getParameter("CATE_HOME"):g=
"cate_id="+a;e+=MyConstant.getParameter("USER_LOG_CATE");jQuery.ajax({type:"POST",beforeSend:function(a){a.setRequestHeader("iswap",1);0==d.willGetToken()&&a.setRequestHeader("session_token",d.getToken())},url:e,data:g,success:function(a){console.log("data ="+a.data);null!=a.data&&void 0!=a.data&&"1"==a.data&&console.log("write log category success")}});break;default:console.log("No type to write listen")}jQuery("#keeng-info").attr("data-url",p);jQuery("#keeng-info").attr("data-msisdn",h);jQuery("#keeng-info").attr("data-item_id",
b);jQuery("#keeng-info").attr("data-item_type",a);jQuery("#keeng-info").attr("data-item_category",c);jQuery("#keeng-info").attr("data-item_name",f);jQuery("#keeng-info").attr("data-item_singer",k);jQuery("#keeng-info").attr("data-item_author",l);jQuery("#keeng-info").attr("data-item_record_copyright",m);jQuery("#keeng-info").attr("data-author_copyright",n)}
var getToday=function(){var b=new Date;return b.getDate()+"-"+(b.getMonth()+1)+"-"+b.getFullYear()},getPhim=function(){var b=new MyOauthClient;b.willGetToken()?msisdn=user_id="":(user_id=b.getUserId(),msisdn=b.getUserMsisdn());jQuery.ajax({type:"GET",url:MyConstant.getParameter("HOME_URL")+"/onphim",data:{id:user_id,msisdn:msisdn},contentType:"application/x-www-form-urlencoded"}).done(function(a){if(0!=a&&null!==a&&"object"===typeof a){myStorage=b.getStorage();var c=new Date,c=c.getDate()+"-"+(c.getMonth()+
1)+"-"+c.getFullYear(),f=b.getData("phimkeeng");myStorage.removeData("isGettingInfo");if(null==f||f!=c)myStorage.setData("phimkeeng",c),MyPopupClient.showPopupOther("false",MyConstant.getParameter("POPUP_PHIM"),"","","","","");myStorage.setData("user_id",a.user_id);myStorage.setData("user_msisdn",a.msisdn);myStorage.setData("user_is_vip","false");myStorage.setData("access_token",a.token);c=new Date;myStorage.setData("access_token_time",c.getTime());myStorage.setData("user_avatar",MyConstant.getParameter("DEFAULT_AVATAR_IMG"));
b.setUserLayout(msisdn)}})};getPhim();var getLink=function(b,a){jQuery.ajax({type:"GET",url:b,data:"",success:function(b){console.log("srcc------"+b);a.src(JSON.parse(b));a.play()}})},getAsyncLink=function(b){var a="";jQuery.ajax({type:"GET",async:!1,url:b,data:"",success:function(b){a=JSON.parse(b)[0].src}});return a};
